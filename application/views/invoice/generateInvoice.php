<style type="text/css">
    .invoce_matter_bg
    {clear:both; padding:0px 0 0 0;}
    .company_struchers
    {margin:0 0 0 0;}
    .company_contents_left
    {width:340px; float:left; margin:0 0 0 20px;}
    .comp_add
    { color:#000; line-height:20px; word-wrap: break-word; width:155px;}
    .comp_add_right
    { color:#000; line-height:20px; word-wrap: break-word;  width:155px; text-align:left; float:right; margin:-76px 0 0 182px;}

    .comp_add_right_ship
    { color:#000; line-height:20px; word-wrap: break-word; text-align:left; width:155px; float:right; margin:10px 0 10px 0;}
    .comp_step_tow
    {color:#000; line-height:20px; margin:10px 0 0 46px; font-weight:normal; word-wrap: break-word;}
    .company_contents_right
    {width:160px; float:left; }
    .invoce_matter_bg_first
    { margin:20px 0 0 0; clear:both;}

    .table {
        -moz-border-bottom-colors: none;
        -moz-border-left-colors: none;
        -moz-border-right-colors: none;
        -moz-border-top-colors: none;
        border-collapse: collapse;
        border-color: #DDDDDD #DDDDDD -moz-use-text-color;
        border-image: none;
        border-style: solid solid none;
        border-width: 1px 1px medium;
        display: table;
        width: 100%;
    }


    .table .table-row-heading {
        display: table-row; border:1px solid #ddd;
    }

    .table .table-row-heading .th {
        background: none repeat scroll 0 0 #549fc6;
        border-bottom: 1px solid #DDDDDD;
        border-right: 1px solid #DDDDDD;
        color: #FFFFFF;
        display: table-cell;
        font-size: 12px;
        font-weight: bold;
        padding: 5px;
        text-align: left;
        vertical-align: baseline;
    }


    .table .spacer {
        display: block;
    }

    .table .table-row {
        display: table-row;
    }

    .table .table-row .td {
        background: none repeat scroll 0 0 #FFFFFF;
        border-bottom: 1px solid #DDDDDD;
        border-right: 1px solid #DDDDDD;
        color: #000000;
        display: table-cell;
        font-size: 12px;
        padding: 4px;
        text-align: left;
        vertical-align: top;
    }
    .list_table .alt .td {
        background: none repeat scroll 0 0 #FFFFFF;
        border-bottom: 1px solid #DDDDDD;
        border-right: 1px solid #DDDDDD;
        color: #000000;
        display: table-cell;
        font-size: 12px;
        padding: 4px;
        text-align: left;
        vertical-align: top;
    }

    .list_table .alt .width5{ width:6%;}
    .list_table .alt .width10{ width:10%;}
    .list_table .alt .width15{ width:15%;}
    .list_table .alt .width20{ width:20%;}
    .list_table .alt .width25{ width:25%;}
    .list_table .alt .width30{ width:30%;}
    .list_table .alt .width35{ width:35%;}
    .list_table .alt .first{ border-left:1px solid #DDDDDD;}
    .wd_inn1{ float:left; width:25px;}
    .wd_inn2{ float:left; width:25px; }
    .wd_inn3{ float:left; width:180px; }
    .wd_inn4{ float:left; width:68px; }
    .wd_inn5{ float:left; width:25px; }
    .wd_inn6{ float:left; width:25px;}
    .wd_inn7{ float:left; width:25px; }
    .wd_inn8{ float:left; width:25px;}

    .cwd_inn1{ float:left; width:25px;word-wrap: break-word;}
    .cwd_inn2{ float:left; width:25px;word-wrap: break-word; }
    .cwd_inn3{ float:left; width:180px;word-wrap: break-word; }
    .cwd_inn4{ float:left; width:68px;word-wrap: break-word; }
    .cwd_inn5{ float:left; width:25px;word-wrap: break-word; }
    .cwd_inn6{ float:left; width:25px;word-wrap: break-word;}
    .cwd_inn7{ float:left; width:55px;word-wrap: break-word; }
    .cwd_inn8{ float:left; width:25px;word-wrap: break-word;}

    .list_table_2 .alt_one .td {
        background: none repeat scroll 0 0 #FFFFFF;
        border-bottom: 1px solid #DDDDDD;
        border-right: 1px solid #DDDDDD;
        color: #000000;
        display: table-cell;
        font-size: 12px;
        padding: 4px;
        text-align: left;
        vertical-align: top;
    }
    .list_table_2 .alt_one .first{ border-left:1px solid #DDDDDD;}
    .list_table_2 .alt_one .width5{ width:1%;}
    .list_table_2 .alt_one .width10{ width:4%;}
    .list_table_2 .alt_one .width15{ width:15%;}
    .list_table_2 .alt_one .width20{ width:20%;}
    .list_table_2 .alt_one .width25{ width:25%;}
    .list_table_2 .alt_one .width30{ width:1%;}
    .list_table_2 .alt_one .width35{ width:35%;}

    .lwd_inn1{ float:left; width:102px;word-wrap: break-word; }
    .lwd_inn2{ float:left; width:25px;word-wrap: break-word; }
    .lwd_inn3{ float:left; width:45px; word-wrap: break-word;}
    .lwd_inn4{ float:left; width:38px; word-wrap: break-word;}
    .lwd_inn5{ float:left; width:42px;word-wrap: break-word; }
    .lwd_inn6{ float:left; width:63px;word-wrap: break-word;}
    .lwd_inn7{ float:left; width:178px;word-wrap: break-word; }
    .lwd_inn8{ float:left; width:89px;word-wrap: break-word;}
    .list_table{  border:0px solid;}
    .list_table_3 .alt_three .td {
        background: none repeat scroll 0 0 #FFFFFF;
        border-bottom: 1px solid #DDDDDD;
        border-right: 1px solid #DDDDDD;
        color: #000000;
        display: table-cell;
        font-size: 12px;
        padding: 4px;
        text-align: left;
        vertical-align: top;
    }
    .list_table_3 .alt_three .first{ border-left:1px solid #DDDDDD;}
    .list_table_3 .alt_three .width5{ width:1%;}
    .list_table_3 .alt_three .width10{ width:4%;}
    .list_table_3 .alt_three .width15{ width:15%;}
    .list_table_3 .alt_three .width20{ width:20%;}
    .list_table_3 .alt_three .width25{ width:25%;}
    .list_table_3 .alt_three .width30{ width:1%;}
    .list_table_3 .alt_three .width35{ width:35%;}

    .bwd_inn1{ float:left; width:209px;word-wrap: break-word; }
    .bwd_inn2{ float:left; width:25px;word-wrap: break-word; }
    .bwd_inn3{ float:left; width:88px;word-wrap: break-word; }
    .bwd_inn4{ float:left; width:112px;word-wrap: break-word; }
    .bwd_inn5{ float:left; width:25px;word-wrap: break-word; }
    .bwd_inn6{ float:left; width:25px;word-wrap: break-word;}
    .bwd_inn7{ float:left; width:178px;word-wrap: break-word; }
    .bwd_inn8{ float:left; width:89px;word-wrap: break-word;}
    .login_button_3 .input_submit {
        background: url("<?php echo HTTP_PATH; ?>/img/submit_btn_1.png") no-repeat scroll 0 0 transparent;
        border: medium none;
        color: #FFFFFF;
        cursor: pointer;
        float: right;
        font-size: 20px;
        height: 40px;
        width: 120px;
        margin:5px 0 0 0;
    }

</style>
<script type="text/javascript" src="<?php echo HTTP_PATH; ?>js/jquery-latest.js"></script>
<script type="text/javascript" src="<?php echo HTTP_PATH; ?>js/jquery.numeric.js"></script>
<script type="text/javascript" src="<?php echo HTTP_PATH; ?>js/jquery.validate.js"></script>
<script>
    $(document).ready(function(){
        $.validator.addMethod('positiveNumber',
        function (value) { 
            return Number(value) > 0;
        }, 'Enter a positive number.');
        
        $.validator.addMethod('lessThan', function(value, element, param) {
            var i = parseInt(value);
            var j = parseInt($(param).val());
            return i < j;
        }, "Must be less than total amount");
        $("#submitInvoice").validate();
        
        
        $('#worksite').change(function(e) {
            $('.all_bg').show();
            $("#fill").html('');
            if(this.value)
                $('#employee_dropdown').load('<?php echo HTTP_PATH; ?>users/getEmployeesList/'+this.value);
            $('.all_bg').hide();
        });
        $('#employee').live('change', function() {
            if(this.value) {
                $("#comapny").val('');
                $.ajax({
                    type: "POST",
                    url: "<?php echo HTTP_PATH ?>invoice/getInvoice/"+this.value, 
                    cache: false,
                    async: false,
                    success: function(result) {
                        if(result!= "0") {
                            $("#fill").html(result);
                        } else {
                            $("#fill").html('');
                            $(".all_bg").hide();
                        }
                        $(".all_bg").hide();
                    },
                    beforeSend: function() {
                        $(".all_bg").show();
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        $("#fill").html('');
                        alert('Sorry, some error has occured');
                        $(".all_bg").hide();
                    }
                });
            } else {
                $("#fill").html('');
                $("#comapny").val('');
            }
        });
        $('#comapny').live('change', function() {
            if(this.value) {
                $.ajax({
                    type: "POST",
                    url: "<?php echo HTTP_PATH ?>invoice/getCompanyAddress/"+this.value, 
                    cache: false,
                    async: false,
                    success: function(result) {
                        if(result!= "0") {
                            var ob = JSON.parse(result);
                            $("#company_address").html(ob.company+"<br>"+ob.address);
                            $("#company_address1").html(ob.company+"<br>"+ob.address);
                            $("#abn").html("A.B.N.: "+ob.abn);
                            $("#acn").html("A.C.N.: "+ob.acn);
                        } else {
                            $(".all_bg").hide();
                        }
                        $(".all_bg").hide();
                    },
                    beforeSend: function() {
                        $(".all_bg").show();
                    },
                    error: function (xhr, ajaxOptions, thrownError) {
                        alert('Sorry, some error has occured');
                        $(".all_bg").hide();
                    }
                });
            }
        });
        $('#description').live('change', function() {
            if(this.value) {
                $("#prize1").html('<?php echo form_input('prize', '', 'class="price_invoice positiveNumber required number" size="7" maxlength="5" id="Prize" lessThan="#total_text"'); ?>');
                
                $("#ex1").html('');
                $("#total_amount").html('$'+($("#total_text").val()));
            }else{
                $("#prize1").html('');
                $("#ex1").html('');
                $("#total_amount").html('$'+($("#total_text").val()));
            }
        });
        $('.price_invoice').live('keyup', function() {
            $("#ex1").html('-$'+this.value);
            $("#total_amount").html('$'+($("#total_text").val() - this.value));
        });
        
    });
</script>

<article id="content"><!-- Page Content -->
    <section class="content_2">
        <section class="top_login_text_head">
            <div class="ribbon_2">
                <p class="ribbon">
                    <strong class="ribbon-content">Generate Invoice </strong>
                </p>
            </div>
        </section>    
        <section class="page-container">
            <section class="contentCol3">
                <h2 class="my_profile"> Generate Invoice </h2>
                <?php if (validation_errors() || $this->session->userdata('message') || $this->session->flashdata('message')) { ?>
                    <div class='ActionMsgBox error' id='msgID'>
                        <?php
                        echo validation_errors();
                        echo $this->session->userdata('message');
                        echo $this->session->flashdata('message');
                        $this->session->unset_userdata('message');
                        ?>
                    </div>
                <?php } ?>
                <?php if ($this->session->userdata('smessage') || $this->session->flashdata('smessage')) { ?>
                    <div class='ActionMsgBox success' id='msgID'>
                        <?php
                        echo $this->session->userdata('smessage');
                        echo $this->session->flashdata('smessage');
                        $this->session->unset_userdata('smessage');
                        ?>
                    </div>
                <?php } ?>       
                <div style="display: none;" class="load-image" id="loading-image">
                    <?php echo img('img/loading4.gif'); ?> 
                </div>

                <div class="field_name"><b>Please Select </b></div>
                <?php echo form_open('invoice/submitInvoice', array('id' => 'submitInvoice')); ?>
                <div class="text_field_bg">
                    <?php echo form_dropdown('worksite_id', $worksites, $this->uri->segment(4), "class = 'textfield_input required' id='worksite'"); ?>
                </div>
                <div class="text_field_bg" id="employee_dropdown">
                    <select id="employee" class="textfield_input required" name="employee"><option>Select Contractor</option></select>
                </div>
                <div class="text_field_bg" id="company_dropdown">
                    <?php echo form_dropdown('company', $companies, '', "class = 'textfield_input required' id='comapny' "); ?>
                </div>
                <div style="margin-bottom: 50px;display: block" id="fill">
                </div>
                <?php echo form_close(); ?>
            </section>
        </section>
    </section>
</article>